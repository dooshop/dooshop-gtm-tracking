___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "categories": [
    "AFFILIATE_MARKETING"
  ],
  "__wm": "VGVtcGxhdGUtQXV0aG9yX2Rvb3Nob3AtU2ltby1BaGF2YQ\u003d\u003d",
  "securityGroups": [],
  "displayName": "dooshop Tracking",
  "brand": {
    "id": "dooshop",
    "displayName": "dooshop",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAIAAAAP3aGbAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAbGVYSWZNTQAqAAAACAAEARoABQAAAAEAAAA+ARsABQAAAAEAAABGASgAAwAAAAEAAgAAh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAAqACAAQAAAABAAABkKADAAQAAAABAAABkAAAAABoArszAAAACXBIWXMAAAsTAAALEwEAmpwYAAACOGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjQwMDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zMjA8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KwT+7qwAAKvlJREFUeAHtnU2sJUd1x5+jKFkwlhIRBZtNjAF7E5OJzcbIksdSiIhkwFG84EuykcBegMSHo4RFFNtRFhAFMBJZ2ERikMD2whHGIAUlkbiWLNhgx8HZ4BAwm2sTgYLkySLZTP739Uy/ulWn61Z/3dt13q/1NNO3u7rqnN+p+t+q6u66V1y8ePGIDQIQgEANBH6lBiOxEQIQgMCGAIJFPYAABKohgGBVEyoMhQAEECzqAAQgUA0BBKuaUGEoBCCAYFEHIACBagggWNWECkMhAAEEizoAAQhUQwDBqiZUGAoBCCBY1AEIQKAaAghWNaHCUAhAAMGiDkAAAtUQQLCqCRWGQgACCBZ1AAIQqIYAglVNqDAUAhBAsKgDEIBANQQQrGpChaEQgACCRR2AAASqIYBgVRMqDIUABBAs6gAEIFANAQSrmlBhKAQggGBRByAAgWoIIFjVhApDIQABBIs6AAEIVEMAwaomVBgKAQggWNQBCECgGgIIVjWhwlAIQADBog5AAALVEECwqgkVhkIAAggWdQACEKiGAIJVTagwFAIQQLCoAxCAQDUEEKxqQoWhEIAAgkUdgAAEqiGAYFUTKgyFAAQQLOoABCBQDQEEq5pQYSgEIIBgUQcgAIFqCCBY1YQKQyEAAQSLOgABCFRDAMGqJlQYCgEIIFjUAQhAoBoCCFY1ocJQCEAAwaIOQAAC1RBAsKoJFYZCAAIIFnUAAhCohgCCVU2oMBQCEECwqAMQgEA1BBCsakKFoRCAAIJFHYAABKohgGBVEyoMhQAEECzqAAQgUA0BBKuaUGEoBCCAYFEHIACBagggWNWECkMhAAEEizoAAQhUQwDBqiZUGAoBCCBY1AEIQKAaAghWNaHCUAhAAMGiDkAAAtUQQLCqCRWGQgACCBZ1AAIQqIYAglVNqDAUAhBAsKgDEIBANQQQrGpChaEQgACCRR2AAASqIYBgVRMqDIUABBAs6gAEIFANAQSrmlBhKAQggGBRByAAgWoIIFjVhApDIQABBIs6AAEIVEMAwaomVBgKAQggWNQBCECgGgIIVjWhwlAIQADBog5AAALVEECwqgkVhkIAAggWdQACEKiGAIJVTagwFAIQQLCoAxCAQDUEEKxqQoWhEIAAgkUdgAAEqiGAYFUTKgyFAAQQLOoABCBQDQEEq5pQYSgEIIBgUQcgAIFqCCBY1YQKQyEAAQSLOgABCFRDAMGqJlQYCgEIIFjUAQhAoBoCCFY1ocJQCEAAwaIOQAAC1RBAsKoJFYZCAAIIFnUAAhCohgCCVU2oMBQCEECwqAMQgEA1BBCsakKFoRCAAIJFHYAABKohgGBVEyoMhQAEECzqAAQgUA0BBKuaUGEoBCCAYFEHIACBagggWNWECkMhAAEEizoAAQhUQwDBqiZUGAoBCCBY1AEIQKAaAghWNaHCUAhAAMGiDkAAAtUQQLCqCRWGQgACCBZ1AAIQqIYAglVNqDAUAhBAsKgDEIBANQQQrGpChaEQgACCRR2AAASqIYBgVRMqDIUABBAs6gAEIFANAQSrmlBhKAQggGBRByAAgWoIIFjVhApDIQABBIs6AAEIVEMAwaomVBgKAQggWNQBCECgGgIIVjWhwlAIQADBog5AAALVEECwqgkVhkIAAggWdQACEKiGAIJVTagwFAIQQLCoAxCAQDUEEKxqQoWhEIAAgkUdgAAEqiGAYFUTKgyFAAQQLOoABCBQDQEEq5pQYSgEIIBgUQcgAIFqCCBY1YQKQyEAAQSLOgABCFRDAMGqJlQYCgEIIFjUAQhAoBoCCFY1ocJQCEDgV0EAgUkIvPijHz9y/quvXvif9955x7lbbp4kTzKBQETgiosXL0aH+AiBAQRuu/1OqZUuvPLMa556/Cv6d0AmXAKBPAGGhHk+nC0ioO5Vo1ZKrZ0Xf/SfRZeRCAI9CSBYPYGR3CLww22FuunsW6xUHIPAWAII1liCXC8C//GjH7ccUKsWBTuTE0CwJkd6GjP8/vM/aN2+/k3XtvvsQGBaAgjWtDxPaW6aw2o9fzOC1bJgZ2oCCNbURE9ffs8G3St5z5Dw9FWB/XmMYO2PtdeSfhh0r/Q0w+uvep1XT/Hr4AQQrIOHoHoDngt6WNe96Y3V+4MDCyaAYC04OJWYFk5g3XT2hkqsxswqCSBYVYZtOUbrMdH1Kz9r7WECq0XBzhwEEKw5qJ6iPKOH2hkSnqLYH8JVBOsQ1B2VGd4i1HQ7rxA6iu0SXUGwlhiVimx69vkXWmuv4wmslgU78xBAsObhempyDYeEN/IK4amJ+6EcRbAORd5DuZpubxdpkD+8lOMhqMv2AcFadnyWbV04gSVLuUW47HB5sA7B8hDFQ/kQLtLABNahonCqykWwTlW4J3Y2fCnnrUxgTUyX7AwCCJYBhUOFBMIhIYs0FEIj2RgCCNYYeqf62vCNHIG4nrcIT3V12JPzCNaeQPsrJly0T94xh+UvxAv0CMFaYFDqMCmccef+YB0xq99KBKv+GB7Ig/CHJ1ik4UBBOHXFIlinLuSTOHz8W14nyyLzzvMkVMlkJ4Gl/PKz7jeFt5wydt9z9wcyZzm1HwLhGzkq0e0E1ovnj159KUZ60wPxET7vi8BSBOuR818rESytB4Bg7atu5MoJg6WguF0WefXBmMKV1xwhWDGU/X1eypAwbAAZ791+k2d8XuSp8JkGt0H5xfMG+6vPGQc5tC8CixCssPbnHWc9gDyfvZ0Nv2BOl2C99vf2BpmCUgKLEKzoiZ7UyvYI6wG0KA64Ey3S4PaZhvXTBuTXnjUOcmhfBBYhWOETPXnH3baNvNsLOxv1iN0GxRwSvv7cwqJxusxZhGCF44sMfrcNI+PzIk+Ftwjdjgf/75dHqWChVoeukIcXrOhnVzJAGA9m4OzzVLgssttXCH9uzbgzHtxnPbPKOrxgFXavZDwz7lYED3AsDJnbRRpeXhlkr77VOMihPRI4vGCF44u8425HH3m3F3Y2msByuwzWy8y4L6zmHZtzeMEKxxcZQp6fTsy4vbxT4SuEss7tt0g6JNQjo/pjOyiBJQjWD0oIuG0YJc4vKc1zwe96ub0Noul2TbpHGxNYEZBDfDywYEXjiwwBJrAycPZ5Kuxhub0Nkt4fFGImsPZZzzrKOrBg8choR1yWezj8jnH7LcIjo0utgAcWrOeeLxoPip7b0cdSa4ZpV3h/UAncjtPNHhYPYZl1Yr8HJ1utQV+8r164oJ9RuXDhQuOCJObKM2fydTr8us44PolaNY0tbHJXX15mYJL8M/ZnTqVWnTlzphlqHdCqLoNDeleeec0BFmlYrza2hc8caGrp137j6LeO/92cG70NeGRUl2iSvp35kj2y6teP/x1tTlEGjQGh5Y0NunghOis4//vLk8A15vW/jzFKsPTM5+qZ7z79zPdWz3zPwvo1HVS1VsO79Zab3/mOt0dp9Eqa/qKD5sfBcyUyTOapme0sSMKqZyBlp6yVzaYZUx2UVepaaji8U6+lCLLnxrM3nLvlbXNbVeJdaPD+9FQrUv37F47WK+PR89Bo1X4tpfD6W4+uuWMjYYO39P6gsjJn3BvDXnrSWDOrKV1myJjr7ppLNVT0S9/YqEC6aFfovoyXbMkM04swZfn+enWiPu1V190d30iVhS9+ZRM7iam5NVErRnTFxYsXzXzyB9X+v3T+a1Kr8JfK85eovb33zjvC1azUbv/0L/4qf1Vz9m//+i/P3XJzScomzQDz2sxlp9RBpub7hm368h1Z9fgTT37z2/9cDi3MXIp/+zv+YH8yEZZ9ef9d77m7lf577n5/GM3LSSb9f706eu7BTXXvu6nl3HR/3HgKM3n2gaNnH4zT/uHXN9LTbuuehkkvbv78ZHqhxv/CQxshyOtUa227I3UQFsEZv2mlMK1uGG1/8q8nPuqsMJZbKNtu/fJOZR8iWI+c/+pjTzw5rNVJBR741H2NFnzuiw8/+sSTkcvmx6ceP184+mikSqJg5tProCTykx+9t7DcfM4TWiXBuu+j904upnn7m7OK+G2339mmfPihz8yonmqTqu5qlmM2tcy3fb53b+tbtxkS+d6fXJI/GfbdTxhttcTOc1+eQCykpy98obPDUmKG+llSz5FDxcfeEIuRupN3//emfInU0x80GJbYpm8FUeruIPebdFfDe9+HPqLVQYeplQzWmOLej/9ZM7IIfzc444sko1A1pKTqAkyiVrJHHcD3f+gjhZKasV85KJ+prNLw9jgEX82UONOpcAJLRcy4jrtE4Zu3jVUrmagv+UffcKRRSa8tHRLqy19/2pSVMkx7FoX5m72SwmuVTNNA//D7Gx0XnzGb8pEoS/gGbzIg7To1CihEMnK9Gpi3Llfoux3sIVhSGTW8cBZjmE0Su0azogbQlVtJb6JV0q5Mhh2XqeoGPvjpzw2+/N6P/7lyGKzvXeXqO0M5T55tV3HN8fAlKn2FzDWn1qiVGtUkm3L7pz8++t4nSjNTO0xbSzP1o0yUVXq2NOvjdOqdpU29JAeppFryVFhUooQvXQC6xBKlWa+MhFraUEaORyQfuzWrdNK96RlN1UKUj7oJhs/WoZ0P+0xrW2qCOkd6WvLhh/6mVxOVVZqhk5KmGU5yRHIv3e9r1Ziiw5eoZhwMqsZ3NUsJxzXv3sysa9P3uVp+oy9672+dnZJvhpYaB+3cwvuPbWJ1r8xxohK0na8mcWNSe2G6I72TUmjU02uTEJSISzTKU1cxL6/KVltfY3SJGaBXf7pxzdwiw9YrM9XJQeWvanD7d06OXN4rmsOaWxEuG2P/n58r2ZttmvO+/1OftE1Mju7NKnU/H/37v0vKn+WAJrDabyzN7r3vzjumL6arZZZMu0gsdHlmfqedh8rYrW5UOnGmKZWo5UunrrtrMyHVDBXDDJVS4xo1XdnTtWmup3uaJr6oi0mTTvlkbkSq5cuY/PS8dPyGj8eF5j93yXd4Vd4wWdXc+Q0vifZ1fyD5vY/dgqU6qpHgfD2FyMj04/dX/5gebI7sTRea4gpb6Z6tknDIsC5EUx2XU2GnOP8tMrzQdCpXeUkXynsB0gspTvpVrzZZ0sPS/IvZfWhdkkKV3GiTGZm5efUdok5Hm3+0k1crWSK/SrTPvPXZlKXLdXcvVd7IkvDjI1eEn4z9QsPWq830fJeyy7D3/STybvcc1oOf/uwB1Soz9JBVGhO13/kGtakPaTZqJwrZ88CnP7tPqzSpXzgbOIZH+Aqh8snEZXgp+tZN6676VuVqpbJVy/W1HN5f10FJXolaKWVeraQOylm57dxkhszuUiVz4JnmuV51jgSlL7JEnqqgkq1hYiaWtko1yrc8IsWr3DDxiSIVmtF894RHjo52CJbulOlv+5K9fso8MqoZon3qQuP2zgl46bs6I3tldHT02S8+PHeJ4br7s6iVHDCXoCoUmsh/NZt3fufSM0HlkrdeRdmcfFRTV7dIxpht/iTd9p4eLBq8qblqHsfcGlHQv722holp/zo7AxiVosRdm6S8xd6VJjouezKXaDC7veUES3Kg5redft+fumbc9QTD/nVBzqsvkylXnZ2D6LtMmrvc8BmUzLfIqPphfnV3dVJ2ltS0BF2u9lC4dXV81NQ1NhlgifpBfWWlNVUjSmlWumV0J00cHdG1Xd1Vzf0Vbr/4NzthM3I3BdG+4PJRXaLncs1NPe71KjyTE6zHnvj6sC6MZoL1Jdz8lTyUEBoU7ZuXa1ym+/pRypKPus3XGja4m6CHZs2yxOpL54c8HjWJVd+a4llZ06/mYDjqnGtZZPMBqIxNO0+pJahbVN6EzKY4RiBk4TDBWq/sp72kgNLfco9SRJqhN5VX4/HCzZT1Rq0Kc0iTyS9Ne5nbdnGdjzWo+XW1TDNbHVTD0xstt7/j7dFznspKL/HoVZ6dE0BRzl2PjO4cl0X56KPu8Zlv2+iRhb6GyZf7j4zbhQOet5Jo6gWXVDrVXRL8UCNSj6IjukScez14EeWQ+RhZMtcPT6QdCn3B6uCY9pnxKj21XqXHxgqEXoFOt50/H60XksxNPZHxNG68P+q2bIoSZ2lW+PqRaYCSmfOMeqNg5Kb5wfRWifLcnijo7GGpJasBlNugF1meevwrerksUivloFYkvdDrNX1vZpndKzWeqP3kjVTpuqWlJxLM3BrD9G8+k/CssKQGSIt7Pcsuq/SCZNe9NsHUqb64pKShnRPuh+NBWW6SnKA4fc2mm0ZG+9kacYzKUmdkpECY41ytLZHZ1itDUJRefZBh/bWoLDllojZNja6Vbemmh+NGUlKeysGUy+1+d6dg6TXd1LCuI2rwan6qyl0JmuO6Aa+HhnYmazMxJ7B69fvUtCSjaRemLaLZkZz10qxUsHrhEgE98LnzdW7hUv8rMjXzMZwXzyQbcCrMecY3cszWmL+vP8CZrku2hx6XUo1fZXS9iguUWOSbt9m90lXqg0y1mV287b6MXZQpamZu9vXZoybt7X63LVhqkOXDNzW88icqpSAammWtPjmZTu7KqvLZZemCXrQu1Ed1ZwpTyr503r1X90pqVdhJMXusJ4C298J+0PaZsZ9Cgb7p7A1js+u6Xl/U5ibNGvN6mplnerBrAitNWX5kQPNOppkvlabuVV7myq1SSi3Ck25ar2rnZoqaOSm2M6s0gfmNtZ3MFqxvfftftpN1flIjv/9T93Wetk68/Mp/WYeNY2nPqFytlJ00qFAXlFiOlHeyosFyM39kOGAdUqep3Cpl8OHiTlb4rp9V8sBjcjb89pqxh6URgTlUkeFq+Xq6uuQB64FedrwfN7IprleGOXrnLrOZk9+SKs1qT7iducbIzJTXKN16FR2YZpTaZJofKR+nsQUr/EaN7dv+3Ktj0lwaPYK4nd/Jp1StdE6r8Z2kyO7p8nIBanLS6n3ZLE9Ovrz9hmC5VZrg67uGlMnhxJRgL5LR4Myo3UgHy+3pXaqaZf7BpfVqo1l6Gl7Psm+PFHqXlV6QNtedY7c0k+iI2WvLi2Dy5NEmy+vvjjI+zMcUkezIu9PL0IIupCFY+joNv1EzJfbqlTT5qFGl4ymziHQ8qGTlSqq17sxsMwfLm2LEp9yq9xQPh1s705sY7an97ITeyZjygfMQ81T7ux4UarPToElv/J3/zc1T4GZ/pE1ZvrNeGWnHT82YLTwz8JEKm5f8Tsdg2TC67NAwlVmvjNzzHUbjglGHDMEKK2g+b63MmU+Qni3PPJ1xL792gJKmphYeKdd3Zbhzor2w0H0mCxdp6DWYHWikxj6FN+81t6VnwdXh0oty6b32XsWbMjGyKZrqk1eK7TtilzxQvyN/VS9Pm8SmvzvzMTuMGf3dmWH/BIZghbeE8hmWj6HafKLxRXs83UnbRvmkcnlfKS235EjYy4iGh5nL5dHBu0sZ87pOhSFLv0W6rhp1XJNZesXMvMmd5iup0vM7ki11uAbL1hxzyab65Ju3eaeyYGYnpbLjSMn8eppFap7ENO9RmknmSEH4DMEq14VUUzLGNKfCr+tMYjXstG23v8eTubA5NcAwXRgN9DKlhBPP5f2+t559SybPZZ4Sk3BqzBynz2K55o/Uzypf1UBGqMPV9LYGTG+ZPY6RTTFt3jLSvHPfEtSSUumWvyRNX3LERJT3V5ekgjKtmKb5y5dtqwzBCr9R876nmpJPr7OFzdtUnMLJL5USCspOk9oE5fm3l/TaObPrOTUzt3Kr5uhXRqXPUYTp9aWDGgpJs9TbKr9Hpt5W35U51U7SpjJ+FGb22rabX+z7hZfiI/pcMBVtXJU/ZAq0+VB+m8961e6e7EwrpqZV2zeODcEKv1FPLJtiL6r9mSzNoUe5YeGQLVNKdKrPr7rO9ixSZNPRUfmPYw/zOilw60DIxPwW2Uo90wc1cs3Ea9E7LZawXX3tAlXve2mW2U7GN8V0SCjjS+yPvMprXJS48KM5G5V32aZ0rrDAomSmVdsziYZgFWU9KFF529vf0CNwpPwhr2E9uKCoHrvlbzWbKt+jJCtpOD8w1yuEVrnGMXU09Ki3Vg1Vn2tnh0vjl3LNGtAVMuzbPqTmnQ675pCe7WJLP61XRsq8eSalaYeE9iD6XGjqKMEq7zE1RZZP548cehQOPEMQUqs+c1jXhtcW7l/o825mk6cIl0OeY44sJKnfcy30dN5kGqw1Ha78w9/Si8LfnjD7DiOHhGae252FeSllctezIKmYKn3e5fUqzlICN+FwVcTSgbmK3NbEWLDKG62yKu8xNa6GtT92PvjcpVblU2bljbwtVgtstfv5HY2Myi0Js+qLS9eWr8yn8eDkQ7YI44F7WCFK7aupaBVNLVOVka31quhBLSWLNg3cRjZFc3Qz/sGuyM5hH1/6hnFdXn1s/T1r5DP4kPnErDR0OxCxYPVqir3e+JUUFqph13jw6qt+u5BGr3dllGev5QC1fk5oxpkzZ8KPmX21/0ICTSZ6P7FQ4pV+wDNxGVObU5HCTi6IOw3YnaCRrcwyu2bjDPNdr8JPl/bHK4uZbb4LY9hxfMgcKHUl3nlcfSvdTk236+5Kj50cWa9O9ts984XE9mzfnR+eN65InpiNBcu4pvuQml/574xquajunLbOdM3FXH3V67bSZT+Ur6Undeu1HGD08GeXvJrWlUOQupUnVlnlr5SbhpkHwyF8V7fXvHDfB9Uh6lpm1+wahPaZCcaP3dJs8zNEjUnbvYlLZprPOoQu9NpPfxOouTz/1JvZYSzxqNA2aag5Sk2sGiVYMkaNaudCBbq7px9c6TOlfa3pZq8hiZR0p2EqRWm0NrxZnHlQahV1QntNwAtCiQypY9Xr9zWkJnN0f8K3PmdcpMEE3fegmrruIaZbKhxRGnMueVhXqM15vWp3T3ZK8jSFcsIeliaJzKWQdRMjf/sytUHApxIsSZW5dJ/UKrHKEKy+VV/rf2pI1fXMgRThXe+5K5oNOYlisic5iBShTSLDuk61acIdGSZ16DJMx5Wg7+KlaUem7+SRlDTzA6uySjD7/qpzalXIYfB+GLVeujy4xFEXShGS+r07Q1PRRjbFtHnLDlOMIvvMoahUxjQyurbko34dx+zIaB4ws+mSdDp8ey48c/XuU1KrNH9d9rsfS681lkiWKIQ1Nb0mPaIhldbV0+oIGs01TwOp4ekRHnUoes3aKOe8XKqDUz4IVW5NP0vzO7rD1YqdTHru+RdK+l+RpyrdHBlpVquk39TmJiz6U27C1Y4oG6u0amiXwraXRzsySVlFB8d/jKbP8nEZW5yahDka6ptvmkl6JMxT7SRtKiVdoTCTdH/wAKpLBdQt0o3RkZsGg+uVkcfO7pV51bCXe9Lilbk5SlUUrEAYgqVWpOaU5pw/omYmdeilJmaGXRNYTWJJQ98iZJi0aYA8ReZJiLWWTnSw+Sil7iVYzVWNbJkZ9jp4X4dVvTJJE4eCJd9buU9Tjj2i7oOemVKDTCYseuec9kS6JKDJOk2v4/nnJ0tsSrMtHEApmSCkS1BoiueGj40agq1X9kMeKjHfvZK/qTvNQb1zrhu1YzZ9W3T9lJkWnrc2Y0g4x9e1VbR9rO1xmKf1PW/2cczE0x78sLVcfVOE2nPftbemsq3vcoDl5Ya97BmZq8pKrdTD0qvLZsPoYfF5I21efcwSR44HzV5bXjdDu7vu1omPOZoLr+3al5tduiC12jmONqf5VJaGclLSwZvckVWmU+r0Wd0rFWUIlr5L5+3/Zz3c2TZm6lBkjdr86I5WWM+k0bqgzVg4k2byU2LVdznAchtCwZqrPoRVVvtaB3lwA9DlXRO3GZ/NptjRVDLZbJ0yRTCvm+H11kzz5ryybZQ9TFyyL6RdF8rTknXi16vOciSjw0ImdxRuk5U6fd2/wWMIloybaRK30+3LJ3aqlRKq8eS143Jmk/2vErsGg20ZUnl1wdqPe9hRifrhj5kK0oRaOPlYEpfelkhi1JCiKqsGoG/ddF4pn3uTVXqVGmS+u7RexRmru6EGM2YzRdCcTe8qxbzdqcSNZqVuduUjLILZ1TUTma6fLw0zjAIUnmr2B4RMk1YKfZcj2dXQbMFSh2LGOYvU58tH8uPBy6n6LdbeXjVsR2ql34wo6T1JRvc2mpY9JT9TNMxlXRV2r/RxlluEelDQbAyawdF3r96q6arQkVdKlgpfk6ZjHuRSBmbpvZQlsqT5aGZbPiRUJupkdU3nKXPB2blg4aa/+cDRo28wpsMaIyXKmjQskeb1qrli699oFFkeMnXHmuDKQnPTEDXbwzUm3Zt89EM4urlu5jnfwfyMe1iuRERPKkXtKkwwyX65WjXF6fc41vNb1fStZNskPpqZhEsMqaASvTbzyR3UYER308wBhWqzvoT1t2m67z6SiEQtpMlXrVe3z8wclKB7HuSSVevVpZ3wv5KHD8L06f56FR8b0GuTmnzzJVvQN2L04OZPDVsjTXWUQt3RExXq4qU2hDYpfddztmGyZt+846k+YPSN0oZM9mw6tr93FP7OhZbNWT+9Uc8unWrKUsh2zeJ3CpZGAeoy9L0ll/qrI6rxhcpS3gibLoYeaCrM2TQsf1DdJQlQr7aqxHMrqRAV9vjy3uXPhuss9npeN59tfFbNUluX4uiUqrj+tKmNRZ2U9WpzvGtTs+meB7l0kdkUs1/vXaWdHDe7VwN6bfJ3o1nHtyNOct/eW3f83up2qviTyChn/Vu4mc+UNRNtpnkiYELYWZzUqqkP2ZT2kLC5RBM3429+qad2Zdnbduo49BqHKrGa7izTK8c/ETZszNVo1nhuZtR0T7DXL9GamZQcDJ9pePOcXblNHd15W10W65t5fdw+238zbqg1qgcR9jvMxGZTLG/JZp4yL92G9dpkSeYdybSUkiMSmvK+lTIU9nRg3mh6IeQSq5RGXbYCtVLCnGDpdN+fRA7NU9NtLg9rf5gg2i/vXrUXHqvD5ifdtdMeHLkjBXzq8fNj5vUbx4fpXZfxskpSNd89wbDcqNM6x6o1YXGbUYCWuBqpFG2OTZvcqVaZpthmNWBn2l6bxpLSF3U9xm8Cosns7Hy2Uch6ZRxsIzWJpMpHRb/kZuWxKTsES2kkOgPaXjNyUUcjqv2G/5cPlU9gXb7i0v8SF/0evXofI2VLovDwQ5/RX6+OXmRM+1EjyqmsEn9ZNUDQW2N67YSvEOrCfZSrL231JvQda85VFVqva8vb5Hpl5Fr+8IFx8fGhyXttzdhQTXrwWFU5qA+rdXgk5X03c3AXUhJzBU757/yGSItuDNPlfVy74uLFi2lW6RE9L/7YE1/XL0KHd7vTZDqi1q6HktoxkbpXhWsh6AGrkW1DRurVFv2saa8n9WWwxEW/GDiJTplM9Jy9rBIKWWgmSA82VunJ/pFM0px3HtFT++3cZSPiOy+ZMsF6daSlkdTy08FIVzGq8dfd1a8noomzdAEm3VXs03gMc/Q7r9GmbkjXYwpRyp0f18dkdk5dt/moaGG5/u4hatJkYv7UthZ9Tb9X1GPVTRIhLYmaLtd7goMMKxWsFoJ6TBIF/au2p1+4avRL1VoJ9EK/3trbfwNrbQt3pA5a3lcLpDQWtqaqF9bcpJe1Wq9Gls+nU6E9zX5j1Suv/KxZeji1Sg92aM5I89wHxKilNdp+sXqvO59BS92c5kgzfasG0DzZpJfXmi98fTM3E/D6qlfVV8dhwNf7NCYeKJe1bgVK0H961PxohT5qa7FIpzRr1nVrdZO0eHvkijipgEuwMptitF5t7v/KtjZkMkm/cKH7hjJMXwn6OHTrLVhDC+K6agi89dwftbaOmcRsM2GnSgKSHj0zFW36etC4+3Db7jmsw9lGyQcgoD5gWGrTdw6PsH9aCKxXhqfhBJZxevZDCNbsiOsqIPyZHA2f9zlerguUf2unveM5ES8EayKQXrLZ/iHCN3pxCz/6E9A0WbqNmH5KMxtwBMEaAM3zJe10u5xc+rLInuNwaN9mek5ttFsI1miEjjLQnd/wsRUmsBzFtqcr65VxwaEnsGQSgmXE5dQeimbcZ1mk4dTCrcvx5gmSyOZDjwdlDoIVxeRUfwwXadB0+8g3B041ytqdN1f1GvlU7RRMEKwpKHrJI1ykgfGgl6gO8mO9ii/TI6MLeEAXwYrjcpo/hz2seRdpOM2Ul++7OR4csEjODJ4iWDNArTNLTbeHrzoWrv5ap69YnSWwXhmnhy2SY2Q06hCCNQqfp4ujGXeGhJ6C28+XRT4y2riAYPULpePUelG89e6Ar163NrBzMAKLfGS0oYFgHaxWLK3g8KWc2RftW5rz2NMSWOojo42BCFYbqNO+Ew4JmXE/vbXh588bvi/gkdHGqs4foTCM5pBfAqFaycsZf3jCL0Mnnulhq3uKFvU8iL/0sA6CfXGFhuPB4zUOr12ciRgEAZ50pw40BLZn3FmkgXqxUAL0sBYamD2bFf7wBIs07Bk+xZUTQLDKWblNqedFw1VleOfZbaTrdwzBqj+Goz0I38hRZjyENZooGcxFAMGai2xF+Ya3CLVIA8siVxS702YqgnXaIm74uz0evNZIwSEILIMAgrWMOBzUirCHxXjwoKGg8B0EEKwdgNyfjhZp4J1n9xGv2kEEq+rwTWB8OB5UdgjWBEzJYjYCCNZsaCvJePt3va6txGrMPKUEEKxTGvjW7fClHF4hbLGws0wCCNYy47I/q8IZ9xvP3rC/gikJAv0JIFj9mTm6IprAooflKLY+XUGwfMa10KvwFUJdwjMNhdxIdigCCNahyC+i3Oeef6G1g/uDLQp2FksAwVpsaPZhWNjD4mdy9kGcMsYRQLDG8av86nAO68azb6ncG8z3TwDB8h/jLg/D+4NKwwRWFyiOL4cAgrWcWOzbklCwtCwyizTsOwCU158AgtWfmZcrwvEgM+5eourcDwTLeYAz7oWCxXgwA4pTyyGAYC0nFnu1RMsia52Gtkh6WC0KdpZMAMFacnRmtC1ZFplfypmRNllPRQDBmopkZflcfdXrWos1HtSke/uRHQgslsAVFy8u91deF0vNh2GrZ7732BNPSqruufsDzGH5iKl7LxAs9yHGQQj4IcCQ0E8s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsCCJb7EOMgBPwQQLD8xBJPIOCeAILlPsQ4CAE/BBAsP7HEEwi4J4BguQ8xDkLADwEEy08s8QQC7gkgWO5DjIMQ8EMAwfITSzyBgHsC/w9IhOf2pHO5kwAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Performance Tracking for dooshop.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "SELECT",
    "name": "tagType",
    "displayName": "Tag Type",
    "selectItems": [
      {
        "value": "lp",
        "displayValue": "Landing Page"
      },
      {
        "value": "conv",
        "displayValue": "Conversion"
      }
    ],
    "simpleValueType": true,
    "help": "If you set the tag type to \u003cstrong\u003eLanding Page\u003c/strong\u003e, the tag will collect the \u003cstrong\u003edooID\u003c/strong\u003e from the URL and store it in a cookie named \u003cstrong\u003e__doo_id\u003c/strong\u003e. If you set the tag type to \u003cstrong\u003eConversion\u003c/strong\u003e, the tag will fire the conversion pixel to dooshop.",
    "defaultValue": "lp",
    "alwaysInSummary": false
  },
  {
    "type": "TEXT",
    "name": "shopId",
    "displayName": "Shop ID",
    "simpleValueType": true,
    "help": "This value is sent to you in the set-up email.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "conv",
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "orderParams",
    "displayName": "Order Details",
    "groupStyle": "ZIPPY_OPEN",
    "subParams": [
      {
        "type": "SELECT",
        "name": "orderId",
        "displayName": "Order ID",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "choose",
            "displayValue": "Choose a variable..."
          }
        ],
        "simpleValueType": true,
        "help": "Choose a Google Tag Manager variable which returns the Order ID.",
        "defaultValue": "choose"
      },
      {
        "type": "TEXT",
        "name": "currency",
        "displayName": "Currency Code",
        "simpleValueType": true,
        "help": "Provide the currency code of the order in ISO 4217 format.",
        "defaultValue": "EUR"
      },
      {
        "type": "SELECT",
        "name": "orderValue",
        "displayName": "Order Value (excl. taxes)",
        "macrosInSelect": true,
        "selectItems": [
          {
            "value": "choose",
            "displayValue": "Choose a variable..."
          }
        ],
        "simpleValueType": true,
        "defaultValue": "choose",
        "help": "Choose a Google Tag Manager variable which returns the value of the order as a number, excluding taxes."
      }
    ],
    "enablingConditions": [
      {
        "paramName": "tagType",
        "paramValue": "conv",
        "type": "EQUALS"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const getContainerVersion = require('getContainerVersion');
const getCookieValues = require('getCookieValues');
const setCookie = require('setCookie');
const sendPixel = require('sendPixel');
const getQueryParameters = require('getQueryParameters');
const getTimestamp = require('getTimestamp');
const enc = require('encodeUriComponent');
const Math = require('Math');
const log = require('logToConsole');

const cookieName = '__doo_id';
const urlBase = 'https://one.do.dmodule1.com/ts/';

const containerVersion = getContainerVersion().version;
const time = Math.round(getTimestamp() / 1000);

if (data.tagType === 'lp') {
  const dooid = getQueryParameters('dooid');
  if (dooid) {
    setCookie(cookieName, dooid, {
      domain: 'auto',
      path: '/',
      'max-age': 60*60*24*30,
      secure: true,
      samesite: 'None'
    });
  }
  data.gtmOnSuccess();
} else if (data.tagType === 'conv') {
  const dooid = getCookieValues(cookieName);
  let url = urlBase + enc(data.shopId) + '/tsa?typ=i&trc=default&ctg=sale&sid=checkout&uv1=GTM&uv2=' + containerVersion;
  if (dooid.length) {
    url += '&uv3=true&tst=' + time;
    if (data.orderId) url += '&cid=' + enc(data.orderId);
    if (data.orderValue) url += '&orv=' + enc(data.orderValue);
    if (data.currency) url += '&orc=' + enc(data.currency);
    url += '&cli=' + enc(dooid[0]);
  } else {
    url += '&uv3=false&tst=' + time;
    if (data.orderId) url += '&cid=' + enc(data.orderId);
    if (data.orderValue) url += '&orv=' + enc(data.orderValue);
    if (data.currency) url += '&orc=' + enc(data.currency);
  }
  sendPixel(url, data.gtmOnSuccess, data.gtmOnFailure);
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedUrls",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://one.do.dmodule1.com/ts/*/tsa*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "__doo_id"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "__doo_id"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "/"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "non_session"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "queryKeys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "dooid"
              }
            ]
          }
        },
        {
          "key": "query",
          "value": {
            "type": 8,
            "boolean": true
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_container_data",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Do nothing if no dooid in URL
  code: "mock('getQueryParameters', key => {\n  if (key === 'dooid') return;\n  else\
    \ fail('getQueryParameters() called with invalid parameter name: ' + key);\n});\n\
    \    \n// Call runCode to run the template's code.\nrunCode(mockData);\n\n// Verify\
    \ that the tag finished successfully.\nassertApi('setCookie').wasNotCalled();\n\
    assertApi('gtmOnSuccess').wasCalled();"
- name: Save URL parameter in cookie
  code: "mock('getQueryParameters', key => {\n  if (key === 'dooid') return '123456789';\n\
    \  else fail('getQueryParameters() called with invalid parameter name: ' + key);\n\
    });\n    \n// Call runCode to run the template's code.\nrunCode(mockData);\n\n\
    // Verify that the tag finished successfully.\nassertApi('setCookie').wasCalledWith('__doo_id',\
    \ '123456789', mockCookieOptions);\nassertApi('gtmOnSuccess').wasCalled();"
- name: Send pixel with uv3=false if dooid not found
  code: "mockData.tagType = 'conv';\nlet success, failure;\n\nmock('getTimestamp',\
    \ () => {\n  return 123456789000;\n});  \nmock('getCookieValues', key => {\n \
    \ if (key === '__doo_id') return [];\n  else fail('getCookieValues() called with\
    \ invalid cookie name: ' + key);\n});\nmock('sendPixel', (url, onsuccess, onfailure)\
    \ => {\n  success = onsuccess;\n  failure = onfailure;\n  onsuccess();\n});\n\n\
    mockUrl = mockUrl.replace('&uv3=true', '&uv3=false');\n  \n// Call runCode to\
    \ run the template's code.\nrunCode(mockData);\n\n// Verify that the tag finished\
    \ successfully.\nassertApi('getTimestamp').wasCalled();\nassertApi('sendPixel').wasCalledWith(mockUrl,\
    \ success, failure);\nassertApi('gtmOnSuccess').wasCalled();"
- name: Send pixel if dooid found
  code: "mockData.tagType = 'conv';\nlet success, failure;\n\nmock('getTimestamp',\
    \ () => {\n  return 123456789000;\n});  \nmock('getCookieValues', key => {\n \
    \ if (key === '__doo_id') return ['123456789'];\n  else fail('getCookieValues()\
    \ called with invalid cookie name: ' + key);\n});\nmock('sendPixel', (url, onsuccess,\
    \ onfailure) => {\n  success = onsuccess;\n  failure = onfailure;\n  onsuccess();\n\
    });\n\nmockUrl += '&cli=123456789';\n  \n// Call runCode to run the template's\
    \ code.\nrunCode(mockData);\n\n// Verify that the tag finished successfully.\n\
    assertApi('getTimestamp').wasCalled();\nassertApi('sendPixel').wasCalledWith(mockUrl,\
    \ success, failure);\nassertApi('gtmOnSuccess').wasCalled();"
setup: |-
  const mockData = {
    tagType: 'lp',
    shopId: 'shopId',
    orderId: 'orderId',
    orderValue: 'orderValue',
    currency: 'currency'
  };

  let mockUrl = 'https://one.do.dmodule1.com/ts/' + mockData.shopId + '/tsa?typ=i&trc=default&ctg=sale&sid=checkout&uv1=GTM&uv2=test&uv3=true&tst=123456789&cid=orderId&orv=orderValue&orc=currency';

  const mockCookieOptions = {
    domain: 'auto',
    path: '/',
    'max-age': 60*60*24*30,
    secure: true,
    samesite: 'None'
  };

  mock('getContainerVersion', () => {
    return {
      version: 'test'
    };
  });


___NOTES___

Created on 09/06/2020, 10:08:14


